# ğŸ§ª DevOps Home Challenge â€“ Infrastructure, CI/CD & Kubernetes Deployment

## ğŸ¯ Objective

Design and provision infrastructure using **Terraform**, build a secure CI/CD pipeline using **Jenkins**, and deploy a containerized application to **Kubernetes** using **manifests or Helm**.

**Choose your deployment target:**
- **ğŸ’» Local**: Docker Desktop + Minikube (recommended for universal access)

---

## ğŸ“¦ Scope Overview

You are expected to:

- Build infrastructure using Terraform (cloud or local)
- Set up a Jenkins-based CI/CD pipeline
- Containerize and deploy a sample application using Kubernetes
- Integrate security tools for IaC and image scanning
- Document and present your solution in a technical walkthrough

**ğŸ’¡ Note**: This challenge is designed to work entirely locally. The local setup provides the same learning experience and demonstrates the same DevOps principles.

---

## ğŸ—ï¸ Part 1 â€“ Infrastructure as Code with Terraform

### ğŸ”¨ Choose Your Path

#### ğŸ’» **Option B: Local Setup (Recommended)**
*Choose this for a fully local development experience*

**Infrastructure Requirements:**
- Docker Desktop with Kubernetes enabled
- Minikube cluster setup via Terraform
- Local Jenkins instance (Docker container)
- Local Docker registry
- Terraform state stored locally or in Git

**Local Setup Benefits:**
- No AWS costs or account requirements
- Faster iteration and testing
- Complete control over environment
- Same DevOps principles and practices

### ğŸ“‹ **Common Requirements (Both Paths)**

1. **Terraform Best Practices:**
   - Modular structure with reusable modules
   - Variables, outputs, and proper state management
   - Version locking and dependency handling
   - Environment separation (dev/staging/prod)

2. **IaC Security:**
   - Integrate `tfsec` or `checkov` for Terraform scanning
   - Fail pipeline on critical misconfigurations
   - Document security decisions and exceptions

3. **Documentation:**
   - Clear setup instructions for your chosen path
   - Architecture diagrams
   - Resource inventory and costs (if using AWS)

---

## ğŸš€ Part 2 â€“ CI/CD with Jenkins

### ğŸ”§ Jenkins Setup Options

#### ğŸ’» **Local Path**: Jenkins in Docker container

```bash
# Local Jenkins setup example
docker run -d -p 8080:8080 -p 50000:50000 \
  -v jenkins_home:/var/jenkins_home \
  -v /var/run/docker.sock:/var/run/docker.sock \
  --name jenkins jenkins/jenkins:lts
```

### ğŸ“‹ Pipeline Requirements (6 Stages)

1. **Code Checkout**
   - Pull source code from Git
   - Set up workspace and environment variables

2. **Static Code Analysis**
   - Scan Terraform code using `tfsec` or `checkov`
   - Optional: Application code scan (SonarQube, ESLint, etc.)
   - Generate security reports

3. **Docker Build & Push**
   - Build Docker image for sample application
   - Tag with build number and commit hash
   - Push to registry (DockerHub for cloud, local registry for local setup)

4. **Image Security Scanning**
   - Scan container images with `Trivy` or `Grype`
   - Check for vulnerabilities and compliance
   - Generate security reports

5. **Deployment**
   - Deploy to Kubernetes cluster
   - Support both Helm charts and YAML manifests
   - Implement environment promotion (dev â†’ staging â†’ prod)
   - Manual approval gates for production

6. **Rollback Capability**
   - Version-based rollback using Git tags
   - Helm revision rollback
   - Database migration rollback (if applicable)

### ğŸ› ï¸ **Local Development Advantages**
- Faster feedback loops
- No cloud resource costs
- Complete environment control
- Easier debugging and troubleshooting

---

## â˜¸ï¸ Part 3 â€“ Kubernetes Deployment

### ğŸ¯ **Deployment Options**

Choose **ONE** of the following approaches:

#### **Option A: YAML Manifests**
*Recommended for learning Kubernetes fundamentals*
- Raw Kubernetes YAML files
- Direct control over all resources
- Good for understanding K8s concepts

#### **Option B: Helm Charts**
*Recommended for production-like experience*
- Templated deployments
- Package management
- Easy upgrades and rollbacks

### ğŸ“‹ **Core Requirements**

#### **Environment Setup**
- **Staging Environment**: `staging` namespace
- **Production Environment**: `production` namespace
- Environment-specific configurations

#### **Application Configuration**
- Resource requests and limits
- Readiness and liveness probes
- Environment variables and ConfigMaps
- Secrets management (non-hardcoded)

#### **Networking & Security**
- Service exposure (ClusterIP, NodePort, or LoadBalancer)
- Ingress configuration with TLS
  - **AWS**: ALB or NLB with ACM certificates
  - **Local**: NGINX Ingress with self-signed certificates
- Network Policies (optional but recommended)

#### **Advanced Features (Optional)**
- RBAC (Role-Based Access Control)
- Pod Security Policies/Standards
- Horizontal Pod Autoscaling (HPA)
- Persistent Volume Claims (if needed)

### ğŸ  **Local Setup Specifics**

```bash
# Enable Ingress on Minikube
minikube addons enable ingress

# Create local registry
docker run -d -p 5000:5000 --name registry registry:2

# Port forwarding for local access
kubectl port-forward service/my-app 8080:80
```

---

## ğŸ” Part 4 â€“ Security Practices

### ğŸ›¡ï¸ **Infrastructure Security**
- **Terraform Scanning**: Use `tfsec` or `checkov` in CI/CD pipeline
- **Policy as Code**: Implement security policies and compliance checks
- **Access Control**: 
  - **AWS**: IAM roles with least-privilege principles
  - **Local**: Kubernetes RBAC and service accounts

### ğŸ³ **Container Security**
- **Image Scanning**: Use `Trivy`, `Grype`, or `Docker Scout`
- **Base Image Security**: Use minimal, updated base images
- **Runtime Security**: Non-root containers, read-only filesystems

### ğŸ”‘ **Secrets Management**
- **Never commit secrets** to version control
- **Jenkins**: Use Jenkins Credentials Store
- **Kubernetes**: Use Secrets and ConfigMaps
- **Local Development**: Use `.env` files (gitignored)
- **AWS**: Integration with AWS Secrets Manager/Parameter Store

### ğŸ“Š **Security Monitoring**
- Security scan reports in CI/CD
- Vulnerability tracking and remediation
- Compliance reporting
- Security metrics and alerting

---

## ğŸ“ Enhanced Project Structure

```
devops-challenge/
â”‚
â”œâ”€â”€ README.md                    # Main documentation
â”œâ”€â”€ SETUP.md                     # Detailed setup instructions
â”œâ”€â”€ ARCHITECTURE.md              # Architecture decisions
â”‚
â”œâ”€â”€ terraform/                   # Infrastructure as Code
â”‚   â”œâ”€â”€ modules/                 # Reusable Terraform modules
â”‚   â”‚   â”œâ”€â”€ networking/
â”‚   â”‚   â”œâ”€â”€ kubernetes/
â”‚   â”‚   â””â”€â”€ security/
â”‚   â”œâ”€â”€ environments/            # Environment-specific configs
â”‚   â”‚   â”œâ”€â”€ local/
â”‚   â”‚   â”œâ”€â”€ staging/
â”‚   â”‚   â””â”€â”€ production/
â”‚   â”œâ”€â”€ main.tf
â”‚   â”œâ”€â”€ variables.tf
â”‚   â”œâ”€â”€ outputs.tf
â”‚   â””â”€â”€ versions.tf
â”‚
â”œâ”€â”€ jenkins/                     # CI/CD Configuration
â”‚   â”œâ”€â”€ Jenkinsfile              # Main pipeline
â”‚   â”œâ”€â”€ scripts/                 # Helper scripts
â”‚   â””â”€â”€ plugins.txt              # Required Jenkins plugins
â”‚
â”œâ”€â”€ kubernetes/                  # K8s Deployments
â”‚   â”œâ”€â”€ manifests/               # Raw YAML files
â”‚   â”‚   â”œâ”€â”€ staging/
â”‚   â”‚   â””â”€â”€ production/
â”‚   â”œâ”€â”€ helm-chart/              # Helm chart (if chosen)
â”‚   â”‚   â”œâ”€â”€ Chart.yaml
â”‚   â”‚   â”œâ”€â”€ values.yaml
â”‚   â”‚   â””â”€â”€ templates/
â”‚   â””â”€â”€ kustomize/               # Kustomize overlays (optional)
â”‚
â”œâ”€â”€ application/                 # Sample Application
â”‚   â”œâ”€â”€ src/                     # Application source code
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”œâ”€â”€ docker-compose.yml       # Local development
â”‚   â””â”€â”€ requirements.txt         # Dependencies
â”‚
â”œâ”€â”€ monitoring/                  # Observability (bonus)
â”‚   â”œâ”€â”€ prometheus/
â”‚   â”œâ”€â”€ grafana/
â”‚   â””â”€â”€ alerting/
â”‚
â”œâ”€â”€ security/                    # Security configurations
â”‚   â”œâ”€â”€ policies/                # Security policies
â”‚   â”œâ”€â”€ scans/                   # Security scan configs
â”‚   â””â”€â”€ certificates/            # TLS certificates
â”‚
â”œâ”€â”€ scripts/                     # Automation scripts
â”‚   â”œâ”€â”€ setup-local.sh           # Local environment setup
â”‚   â”œâ”€â”€ deploy.sh                # Deployment helper
â”‚   â””â”€â”€ cleanup.sh               # Environment cleanup
â”‚
â””â”€â”€ docs/                        # Additional documentation
    â”œâ”€â”€ images/                  # Architecture diagrams
    â”œâ”€â”€ troubleshooting.md
    â””â”€â”€ best-practices.md
```
### ğŸ“‹ **Required Deliverables**

#### **Code & Configuration**
- Complete Terraform infrastructure code
- Jenkins pipeline configuration (Jenkinsfile)
- Kubernetes manifests or Helm charts
- Sample application with Dockerfile
- All supporting scripts and configurations

#### **Documentation**
- **README.md**: Project overview and quick start
- **SETUP.md**: Detailed setup instructions for your chosen path
- **ARCHITECTURE.md**: Technical decisions and trade-offs
- Architecture diagrams (draw.io, Lucidchart, or similar)
- Security considerations and implementations

### ğŸ“Š **Documentation Requirements**

Your documentation should include:

1. **Setup Instructions**
   - Prerequisites and dependencies
   - Step-by-step deployment guide
   - Troubleshooting common issues

2. **Architecture Decisions**
   - Why you chose cloud vs local
   - Technology stack justification
   - Security implementation approach
   - Scalability considerations

3. **Lessons Learned**
   - Challenges faced and solutions
   - What you would improve with more time
   - Alternative approaches considered

4. **Demo Instructions**
   - How to test the deployed application
   - How to trigger the CI/CD pipeline
   - How to perform rollbacks